# Load GEFCOM14 demand data between 17:00 and 22:00
load("GEF14_mvn_d6_17_22.RData")
###############################################################################
# Joint mean and covariance modelling
###############################################################################
# We model demand at 17, 18, 19 and 20
d <- 4
# Formula for the mean demand and the modified Cholesky decomposition of the 4x4 covariance matrix
# Example of model formula specification
my_k = 15
my_bs = "tp"
form_full <- list(load_h17 | load_h18  ~ dow + s(doy, k = my_k, bs = my_bs),
load_h19 | load_h20  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_11 | Th_22 | Th_33 | Th_44  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_12 | Th_23 | Th_34 ~ s(doy, k = my_k, bs = my_bs),
load_h17 ~ load24_h17 + s(temp95_h17),
load_h18 ~ load24_h18 + s(temp95_h18),
load_h19 ~ load24_h19 + s(temp95_h19),
load_h20 ~ load24_h20 + s(temp95_h20),
Th_11 ~ s(temp95_h17),
Th_22 ~ s(temp95_h18),
Th_33 ~ s(temp95_h19),
Th_44 ~ s(temp95_h20),
Th_24 ~ dow,
Th_13 ~ s(doy))
# You can specify also element by element
form_full2 <- list(load_h17 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h17 + s(temp95_h17),
load_h18 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h18 + s(temp95_h18),
load_h19 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h19 + s(temp95_h19),
load_h20  ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h20 + s(temp95_h20),
Th_11 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h17),
Th_22 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h18),
Th_33 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h19),
Th_44 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h20),
Th_12 ~ s(doy, k = my_k, bs = my_bs),
Th_23 ~ s(doy, k = my_k, bs = my_bs),
Th_34 ~ s(doy, k = my_k, bs = my_bs),
Th_24 ~ dow,
Th_13 ~ s(doy))
# Fit model: mcd - Fellner Schall
fit <- gam_scm(form_full, family = mvn_scm(d, nb = 1, param = "mcd"), data = GEF14_data_d6)
library(SCM)
library(SCM)
rm(list=ls())
library(SCM)
library(mgcv)
setwd("C:/Users/Gioia/Desktop/covmodEDF/EDF")
# Load GEFCOM14 demand data between 17:00 and 22:00
load("GEF14_mvn_d6_17_22.RData")
###############################################################################
# Joint mean and covariance modelling
###############################################################################
# We model demand at 17, 18, 19 and 20
d <- 4
# Formula for the mean demand and the modified Cholesky decomposition of the 4x4 covariance matrix
# Example of model formula specification
my_k = 15
my_bs = "tp"
form_full <- list(load_h17 | load_h18  ~ dow + s(doy, k = my_k, bs = my_bs),
load_h19 | load_h20  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_11 | Th_22 | Th_33 | Th_44  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_12 | Th_23 | Th_34 ~ s(doy, k = my_k, bs = my_bs),
load_h17 ~ load24_h17 + s(temp95_h17),
load_h18 ~ load24_h18 + s(temp95_h18),
load_h19 ~ load24_h19 + s(temp95_h19),
load_h20 ~ load24_h20 + s(temp95_h20),
Th_11 ~ s(temp95_h17),
Th_22 ~ s(temp95_h18),
Th_33 ~ s(temp95_h19),
Th_44 ~ s(temp95_h20),
Th_24 ~ dow,
Th_13 ~ s(doy))
# You can specify also element by element
form_full2 <- list(load_h17 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h17 + s(temp95_h17),
load_h18 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h18 + s(temp95_h18),
load_h19 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h19 + s(temp95_h19),
load_h20  ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h20 + s(temp95_h20),
Th_11 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h17),
Th_22 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h18),
Th_33 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h19),
Th_44 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h20),
Th_12 ~ s(doy, k = my_k, bs = my_bs),
Th_23 ~ s(doy, k = my_k, bs = my_bs),
Th_34 ~ s(doy, k = my_k, bs = my_bs),
Th_24 ~ dow,
Th_13 ~ s(doy))
# Fit model: mcd - Fellner Schall
fit <- gam_scm(form_full, family = mvn_scm(d, nb = 1, param = "mcd"), data = GEF14_data_d6)
ETA <- matrix(rnorm(14*2),2,14, byrow=TRUE)
fit$family$jacobian(ETA, 1)
fit$family$jacobian2(ETA, 1)
ETA <- matrix(rnorm(14*2),2,14, byrow=TRUE)
jjjj<-1
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-2
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-3
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-4
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-5
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-6
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-7
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-8
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-9
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-10
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-11
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-12
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-13
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj<-14
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
# Fit model: logm (only Fellner - Schall is available)
fit_logm <- gam_scm(form_full, family = mvn_scm(d, nb = 1, param = "logm"), data = GEF14_data_d6)
cov(residuals(fit, type = "response"))
cov(GEF14_data_d6[,1:4])
fit$family$rd(predict(fit)) #random generation
fit$fitted_values
fit$fitted.values[,1:4]
cov(fit$family$rd(predict(fit))
- fit$fitted.values[ , 1:4])
cov(residuals(fit, type = "response"))
cov(fit$family$rd(predict(fit))
cov(fit$family$rd(predict(fit)) )
cov(fit$family$rd(predict(fit)))
cov(GEF14_data_d6[,1:4])
cov(fit$family$rd(predict(fit)))
fit$fitted.values[ , 1:4])
fit$fitted.values[ , 1:4]
fit$family$rd(predict(fit))- fit$fitted.values[ , 1:4]
library(SCM)
rm(list=ls())
library(SCM)
library(mgcv)
setwd("C:/Users/Gioia/Desktop/covmodEDF/EDF")
# Load GEFCOM14 demand data between 17:00 and 22:00
load("GEF14_mvn_d6_17_22.RData")
###############################################################################
# Joint mean and covariance modelling
###############################################################################
# We model demand at 17, 18, 19 and 20
d <- 4
# Formula for the mean demand and the modified Cholesky decomposition of the 4x4 covariance matrix
# Example of model formula specification
my_k = 15
my_bs = "tp"
form_full <- list(load_h17 | load_h18  ~ dow + s(doy, k = my_k, bs = my_bs),
load_h19 | load_h20  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_11 | Th_22 | Th_33 | Th_44  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_12 | Th_23 | Th_34 ~ s(doy, k = my_k, bs = my_bs),
load_h17 ~ load24_h17 + s(temp95_h17),
load_h18 ~ load24_h18 + s(temp95_h18),
load_h19 ~ load24_h19 + s(temp95_h19),
load_h20 ~ load24_h20 + s(temp95_h20),
Th_11 ~ s(temp95_h17),
Th_22 ~ s(temp95_h18),
Th_33 ~ s(temp95_h19),
Th_44 ~ s(temp95_h20),
Th_24 ~ dow,
Th_13 ~ s(doy))
# You can specify also element by element
form_full2 <- list(load_h17 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h17 + s(temp95_h17),
load_h18 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h18 + s(temp95_h18),
load_h19 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h19 + s(temp95_h19),
load_h20  ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h20 + s(temp95_h20),
Th_11 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h17),
Th_22 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h18),
Th_33 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h19),
Th_44 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h20),
Th_12 ~ s(doy, k = my_k, bs = my_bs),
Th_23 ~ s(doy, k = my_k, bs = my_bs),
Th_34 ~ s(doy, k = my_k, bs = my_bs),
Th_24 ~ dow,
Th_13 ~ s(doy))
# Fit model: mcd - Fellner Schall
fit <- gam_scm(form_full, family = mvn_scm(d, nb = 1, param = "mcd"), data = GEF14_data_d6)
ETA <- matrix(rnorm(14*2),2,14, byrow=TRUE)
jjjj<-14
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
cov(residuals(fit, type = "response"))
cov(fit$family$rd(predict(fit)) - fit$fitted.values[ , 1:4])
library(SCM)
rm(list=ls())
library(SCM)
library(mgcv)
setwd("C:/Users/Gioia/Desktop/covmodEDF/EDF")
# Load GEFCOM14 demand data between 17:00 and 22:00
load("GEF14_mvn_d6_17_22.RData")
###############################################################################
# Joint mean and covariance modelling
###############################################################################
# We model demand at 17, 18, 19 and 20
d <- 4
# Formula for the mean demand and the modified Cholesky decomposition of the 4x4 covariance matrix
# Example of model formula specification
my_k = 15
my_bs = "tp"
form_full <- list(load_h17 | load_h18  ~ dow + s(doy, k = my_k, bs = my_bs),
load_h19 | load_h20  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_11 | Th_22 | Th_33 | Th_44  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_12 | Th_23 | Th_34 ~ s(doy, k = my_k, bs = my_bs),
load_h17 ~ load24_h17 + s(temp95_h17),
load_h18 ~ load24_h18 + s(temp95_h18),
load_h19 ~ load24_h19 + s(temp95_h19),
load_h20 ~ load24_h20 + s(temp95_h20),
Th_11 ~ s(temp95_h17),
Th_22 ~ s(temp95_h18),
Th_33 ~ s(temp95_h19),
Th_44 ~ s(temp95_h20),
Th_24 ~ dow,
Th_13 ~ s(doy))
# Fit model: mcd - Fellner Schall
fit <- gam_scm(form_full, family = mvn_scm(d, nb = 1, param = "mcd"), data = GEF14_data_d6)
ETA <- matrix(rnorm(14*2),2,14, byrow=TRUE)
cov(residuals(fit, type = "response"))
cov(fit$family$rd(predict(fit)) - fit$fitted.values[ , 1:4])
library(SCM)
rm(list=ls())
library(SCM)
library(mgcv)
setwd("C:/Users/Gioia/Desktop/covmodEDF/EDF")
# Load GEFCOM14 demand data between 17:00 and 22:00
load("GEF14_mvn_d6_17_22.RData")
###############################################################################
# Joint mean and covariance modelling
###############################################################################
# We model demand at 17, 18, 19 and 20
d <- 4
# Formula for the mean demand and the modified Cholesky decomposition of the 4x4 covariance matrix
# Example of model formula specification
my_k = 15
my_bs = "tp"
form_full <- list(load_h17 | load_h18  ~ dow + s(doy, k = my_k, bs = my_bs),
load_h19 | load_h20  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_11 | Th_22 | Th_33 | Th_44  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_12 | Th_23 | Th_34 ~ s(doy, k = my_k, bs = my_bs),
load_h17 ~ load24_h17 + s(temp95_h17),
load_h18 ~ load24_h18 + s(temp95_h18),
load_h19 ~ load24_h19 + s(temp95_h19),
load_h20 ~ load24_h20 + s(temp95_h20),
Th_11 ~ s(temp95_h17),
Th_22 ~ s(temp95_h18),
Th_33 ~ s(temp95_h19),
Th_44 ~ s(temp95_h20),
Th_24 ~ dow,
Th_13 ~ s(doy))
# Note that in the previous formula the only elements which is not modelled is Th_14 (so an intercept is considered by default), while:
# the mean vector has a common specification (the first two lines could be joined) and a varying specification (lines 5 to 8)
# the components Th_11, Th_22, Th_33 and Th_44 have a common specification (line 3) and a varying specification (lines 9 and 12)
# the component Th_12  Th_23  Th_34 are specified in the common model formula (| . | . | ) statement (line 4) and
# the component Th_24 and Th_13 instead are specified separately (lines 13 and 14), despite they don't have node specific variables involved
# You can specify also element by element
form_full2 <- list(load_h17 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h17 + s(temp95_h17),
load_h18 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h18 + s(temp95_h18),
load_h19 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h19 + s(temp95_h19),
load_h20  ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h20 + s(temp95_h20),
Th_11 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h17),
Th_22 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h18),
Th_33 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h19),
Th_44 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h20),
Th_12 ~ s(doy, k = my_k, bs = my_bs),
Th_23 ~ s(doy, k = my_k, bs = my_bs),
Th_34 ~ s(doy, k = my_k, bs = my_bs),
Th_24 ~ dow,
Th_13 ~ s(doy))
# Fit model: mcd - Fellner Schall
fit <- gam_scm(form_full, family = mvn_scm(d, nb = 1, param = "mcd"), data = GEF14_data_d6)
# param mcd is the default (you can avoid in the family specification)
# nb is the number of observations' blocks (useful for large datasets and/or large number of dimension of the outcome)
ETA <- matrix(rnorm(14*2),2,14, byrow=TRUE)
jjjj<-14
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
cov(residuals(fit, type = "response"))
cov(fit$family$rd(predict(fit)) - fit$fitted.values[ , 1:4])
C
library(SCM)
rm(list=ls())
library(SCM)
library(mgcv)
setwd("C:/Users/Gioia/Desktop/covmodEDF/EDF")
# Load GEFCOM14 demand data between 17:00 and 22:00
load("GEF14_mvn_d6_17_22.RData")
###############################################################################
# Joint mean and covariance modelling
###############################################################################
# We model demand at 17, 18, 19 and 20
d <- 6
# Formula for the mean demand and the modified Cholesky decomposition of the 4x4 covariance matrix
# Example of model formula specification
my_k = 10
my_bs = "tp"
form_full <- list(load_h17 | load_h18  ~ dow + s(doy, k = my_k, bs = my_bs),
load_h19 | load_h20  ~ dow + s(doy, k = my_k, bs = my_bs),
load_h21 | load_h22  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_11 | Th_22 | Th_33 | Th_44 | Th_55 | Th_66  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_12 | Th_23 | Th_34 | Th_45 | Th_56 ~ s(doy, k = my_k, bs = my_bs),
load_h17 ~ load24_h17 + s(temp95_h17),
load_h18 ~ load24_h18 + s(temp95_h18),
load_h19 ~ load24_h19 + s(temp95_h19),
load_h20 ~ load24_h20 + s(temp95_h20),
load_h21 ~ load24_h21 + s(temp95_h21),
load_h22 ~ load24_h22 + s(temp95_h22),
Th_11 ~ s(temp95_h17),
Th_22 ~ s(temp95_h18),
Th_33 ~ s(temp95_h19),
Th_44 ~ s(temp95_h20),
Th_55 ~ s(temp95_h19),
Th_66 ~ s(temp95_h20),
Th_24 ~ s(doy),
Th_13 ~ s(doy),
Th_35 ~ s(doy),
Th_46 ~ s(doy))
# You can specify also element by element
form_full2 <- list(load_h17 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h17 + s(temp95_h17),
load_h18 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h18 + s(temp95_h18),
load_h19 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h19 + s(temp95_h19),
load_h20  ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h20 + s(temp95_h20),
Th_11 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h17),
Th_22 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h18),
Th_33 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h19),
Th_44 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h20),
Th_12 ~ s(doy, k = my_k, bs = my_bs),
Th_23 ~ s(doy, k = my_k, bs = my_bs),
Th_34 ~ s(doy, k = my_k, bs = my_bs),
Th_24 ~ dow,
Th_13 ~ s(doy))
# Fit model: mcd - Fellner Schall
fit <- gam_scm(form_full, family = mvn_scm(d, nb = 1, param = "mcd"), data = GEF14_data_d6)
ETA <- matrix(rnorm(27*2),2,27, byrow=TRUE)
jjjj <- 1
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
library(SCM)
rm(list=ls())
library(SCM)
library(mgcv)
setwd("C:/Users/Gioia/Desktop/covmodEDF/EDF")
# Load GEFCOM14 demand data between 17:00 and 22:00
load("GEF14_mvn_d6_17_22.RData")
###############################################################################
# Joint mean and covariance modelling
###############################################################################
# We model demand at 17, 18, 19 and 20
d <- 6
# Formula for the mean demand and the modified Cholesky decomposition of the 4x4 covariance matrix
# Example of model formula specification
my_k = 10
my_bs = "tp"
form_full <- list(load_h17 | load_h18  ~ dow + s(doy, k = my_k, bs = my_bs),
load_h19 | load_h20  ~ dow + s(doy, k = my_k, bs = my_bs),
load_h21 | load_h22  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_11 | Th_22 | Th_33 | Th_44 | Th_55 | Th_66  ~ dow + s(doy, k = my_k, bs = my_bs),
Th_12 | Th_23 | Th_34 | Th_45 | Th_56 ~ s(doy, k = my_k, bs = my_bs),
load_h17 ~ load24_h17 + s(temp95_h17),
load_h18 ~ load24_h18 + s(temp95_h18),
load_h19 ~ load24_h19 + s(temp95_h19),
load_h20 ~ load24_h20 + s(temp95_h20),
load_h21 ~ load24_h21 + s(temp95_h21),
load_h22 ~ load24_h22 + s(temp95_h22),
Th_11 ~ s(temp95_h17),
Th_22 ~ s(temp95_h18),
Th_33 ~ s(temp95_h19),
Th_44 ~ s(temp95_h20),
Th_55 ~ s(temp95_h19),
Th_66 ~ s(temp95_h20),
Th_24 ~ s(doy),
Th_13 ~ s(doy),
Th_35 ~ s(doy),
Th_46 ~ s(doy))
# You can specify also element by element
form_full2 <- list(load_h17 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h17 + s(temp95_h17),
load_h18 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h18 + s(temp95_h18),
load_h19 ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h19 + s(temp95_h19),
load_h20  ~ dow + s(doy, k = my_k, bs = my_bs) + load24_h20 + s(temp95_h20),
Th_11 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h17),
Th_22 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h18),
Th_33 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h19),
Th_44 ~ dow + s(doy, k = my_k, bs = my_bs) + s(temp95_h20),
Th_12 ~ s(doy, k = my_k, bs = my_bs),
Th_23 ~ s(doy, k = my_k, bs = my_bs),
Th_34 ~ s(doy, k = my_k, bs = my_bs),
Th_24 ~ dow,
Th_13 ~ s(doy))
# Fit model: mcd - Fellner Schall
fit <- gam_scm(form_full, family = mvn_scm(d, nb = 1, param = "mcd"), data = GEF14_data_d6)
ETA <- matrix(rnorm(27*2),2,27, byrow=TRUE)
jjjj <- 1
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 2
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 3
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 4
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 5
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 6
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 7
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 8
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 9
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 10
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 11
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 12
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 13
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 14
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 15
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 16
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 17
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 18
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 19
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 20
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 21
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 22
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 23
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 24
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 25
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 26
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
jjjj <- 27
fit$family$jacobian(ETA, jjjj)
fit$family$jacobian2(ETA, jjjj)
fit
fit2
plot(fit, scale=FALSE, pages=2)
plot(fit, scale=FALSE, pages=2)
summary(fit) # by default the intercepts are removed by the summary
residuals(fit) #By default residual of type deviance
residuals(fit) #By default residual of type deviance
predict(fit) # predict in terms of the lpi
predict(fit, type = "response") # predict in terms of (mean, variance and correlation)
# You could obtain the predicted values of the covariance, in this way:
fit$family$put_cflag(FALSE)
predict(fit, type = "response") # predict in terms of (mean, variance and covariance)
predict(fit, type = "response", se=TRUE) # you could obtain the std. errors
fit$family$rd(predict(fit))  #random generation
cov(residuals(fit, type = "response"))
cov(fit$family$rd(predict(fit)) - fit$fitted.values[ , 1:6])
# Fit model: mcd - bfgs
fit_bfgs <- gam_scm(form_full, family = mvn_scm(d, nb = 6, param = "mcd"), data = GEF14_data_d6, optimizer = "bfgs")
# Fit model: logm (only Fellner - Schall is available)
fit_logm <- gam_scm(form_full, family = mvn_scm(d, nb = 1, param = "logm"), data = GEF14_data_d6)
library(SCM)
